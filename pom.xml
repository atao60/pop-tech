<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>popsuite-blog</groupId>
    <artifactId>pop-tech</artifactId>
    <version>1.0.2-SNAPSHOT</version>
    <packaging>jar</packaging>

    <name>Pop Tech</name>
    <description>Pop Tech - Un blog personnel sur la programmation informatique</description>
    <url>https://${repository.domain}/{repository.user}/${repository.name}</url>
    <inceptionYear>2014</inceptionYear>

    <properties>

        <jbake.port>8083</jbake.port>
        <jbake.inputDirectory>${project.basedir}/src/jbake/</jbake.inputDirectory>

        <maven.install.skip>false</maven.install.skip>
<!-- 
        <maven.deploy.skip>true</maven.deploy.skip>
        <maven.test.skip>true</maven.test.skip>
        <jar.skipIfEmpty>true</jar.skipIfEmpty>
 -->
        <!-- Java, JVM and Encoding -->

        <site.encoding>UTF-8</site.encoding>
        <project.build.sourceEncoding>${site.encoding}</project.build.sourceEncoding>
        <project.reporting.outputEncoding>${site.encoding}</project.reporting.outputEncoding>

        <jdk.version>1.8</jdk.version>
        <maven.compiler.source>${jdk.version}</maven.compiler.source>
        <maven.compiler.target>${jdk.version}</maven.compiler.target>
        <maven.compiler.fork>true</maven.compiler.fork>
        <maven.compiler.compilerVersion>${jdk.version}</maven.compiler.compilerVersion>
        <maven.compiler.verbose>true</maven.compiler.verbose>
        <maven.compiler.optimize>true</maven.compiler.optimize>
        <maven.compiler.debug>true</maven.compiler.debug>

        <xtend.version>2.9.0.beta5</xtend.version>
        <xtend.maven.version>${xtend.version}</xtend.maven.version>
        <xtend.outputDir>${project.build.directory}/xtend-gen/main</xtend.outputDir>
        <xtend.testOutputDir>${project.build.directory}/xtend-gen/test</xtend.testOutputDir>

        <!-- Maven Management -->

        <maven.minimal.version>3.3.1</maven.minimal.version>

        <sviperll.extension.version>0.16</sviperll.extension.version>

        <jbake.maven.plugin.version>0.0.9</jbake.maven.plugin.version>
        <properties.maven.plugin.version>1.0-alpha-2</properties.maven.plugin.version>
        <maven.scm.publish.plugin.version>1.1</maven.scm.publish.plugin.version>
        <gmavenplus.plugin.version>1.5</gmavenplus.plugin.version><!-- 1.2 -->
        <maven.clean.plugin.version>3.0.0</maven.clean.plugin.version><!-- 2.6.1 -->
        <download.maven.plugin.version>1.2.1</download.maven.plugin.version>
        <maven.resources.plugin.version>2.7</maven.resources.plugin.version>
        <minify.maven.plugin.version>1.7.4</minify.maven.plugin.version>
        <replacer.plugin.version>1.5.3</replacer.plugin.version>
        <coreext.maven.plugin.version>${sviperll.extension.version}</coreext.maven.plugin.version>

        <replacer.plugin.version>1.5.3</replacer.plugin.version>
        <maven.antrun.plugin.version>1.8</maven.antrun.plugin.version>

        <build.helper.maven.plugin.version>1.9.1</build.helper.maven.plugin.version>
        <maven.enforcer.plugin.version>1.4.1</maven.enforcer.plugin.version>
        <versions.maven.plugin.version>2.2</versions.maven.plugin.version>
        <coreext.maven.plugin.version>${sviperll.extension.version}</coreext.maven.plugin.version>
        <maven.dependency.plugin.version>2.10</maven.dependency.plugin.version>

        <maven.compiler.plugin.version>3.3</maven.compiler.plugin.version>
        <maven.surefire.plugin.version>2.19</maven.surefire.plugin.version><!-- 2.18.1 -->
        <maven.failsafe.plugin.version>2.19</maven.failsafe.plugin.version><!-- 2.18.1 -->
        <maven.jar.plugin.version>2.6</maven.jar.plugin.version>
        <maven.war.plugin.version>2.6</maven.war.plugin.version>
        <maven.shade.plugin.version>2.4.1</maven.shade.plugin.version>
        <maven.assembly.plugin.version>2.5.5</maven.assembly.plugin.version>

        <maven.install.plugin.version>2.5.2</maven.install.plugin.version>
        <maven.deploy.plugin.version>2.8.2</maven.deploy.plugin.version>
        <maven.site.plugin.version>3.4</maven.site.plugin.version>


        <!-- Dependency Management -->

        <slf4j.version>1.7.12</slf4j.version><!-- 1.7.9 -->
        <logback.version>1.1.3</logback.version><!-- 1.1.2 -->
        <groovy.version>2.4.5</groovy.version><!-- 2.3.8, available: 2.3.11 and 2.4.5 -->
        <freemarker.version>2.3.23</freemarker.version><!-- 2.3.21 -->
        <markdown.version>1.6.0</markdown.version>
        <asciidoc.version>1.5.2</asciidoc.version>
        <rss.version>1.5.1</rss.version><!-- 1.5.0 -->
        <tika.version>1.11</tika.version><!-- 1.7 -->
        <jbake.version>2.4.0</jbake.version>
        <commons.lang3.version>3.4</commons.lang3.version><!-- 3.3.2 -->
        <junit.version>4.12</junit.version>
        <hamcrest.version>1.3</hamcrest.version>
        
        <!-- Asset Management -->

        <lib.min><!--'.min' or void-->
            .min
        </lib.min>
        <bootstrap.version>3.3.5</bootstrap.version><!-- 3.3.1, available 3.3.4, 3.3.5 -->
        <jquery.version>1.11.3</jquery.version><!-- 1.11.2, available: 1.11.3; no need for 2.1.x -->
        <syntaxhighlighter.version><!-- 3.0.83, 3.0.9 exists but unavailable as webjars-->
            3.0.83
        </syntaxhighlighter.version>
        <html5shiv.version>3.7.3</html5shiv.version><!-- 3.7.2 -->
        <respond.version>1.4.2</respond.version><!-- 1.4.2 -->
        <fontawesome.version>4.4.0</fontawesome.version><!-- 4.2.0 -->
        <prettify.version>r298</prettify.version><!-- 3.7.2, available 3.7.3; To be removed? See syntaxhighlighter -->
        <foundation.version>5.5.0</foundation.version><!-- 5.5.0, available 5.5.2; To be removed? See Bootstrap/Bootswatch-->
        <bootswatch.version>3.3.5</bootswatch.version>

        <bootswatch.style><!-- yeti -->
            yeti
        </bootswatch.style>

        <cdn.url>http://cdnjs.cloudflare.com/ajax/libs/</cdn.url>
        <shl.site.url>http://alexgorbatchev.com/SyntaxHighlighter/</shl.site.url>
        <shl.url>http://alexgorbatchev.com/pub/sh/</shl.url>

        <!-- Publishing Management -->

        <repository.domain>github.com</repository.domain>
        <repository.user>atao60</repository.user>
        <repository.name>pop-tech</repository.name>
        <site.path>${repository.domain}/${repository.user}/${repository.name}</site.path>

        <scm.publish.scmBranch>gh-pages</scm.publish.scmBranch>
        <scm.publish.pubScmUrl>
            scm:git:git@${repository.domain}:${repository.user}/${repository.name}.git
        </scm.publish.pubScmUrl>
        
        <!-- Other properties also used by jbake -->

        <inception.year>${project.inceptionYear}</inception.year>
        <site.name>${project.name}</site.name>
        <site.description>${project.description}</site.description>
        <site.logo>poptech.jpg</site.logo>

        <asset.folder>assets</asset.folder>
        <template.folder>templates</template.folder>
        <content.folder>content</content.folder>

    </properties>

    <prerequisites>
        <!-- Setup to make versions plugin happy even if it's not a maven plugin project -->
        <maven>${maven.minimal.version}</maven>
    </prerequisites>

    <build>
        <finalName>${repository.name}</finalName>

        <plugins>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>build-helper-maven-plugin</artifactId>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>properties-maven-plugin</artifactId>
            </plugin>
            <plugin>
                <groupId>com.google.code.maven-replacer-plugin</groupId>
                <artifactId>replacer</artifactId>
            </plugin>
            <plugin>
                <groupId>org.eclipse.xtend</groupId>
                <artifactId>xtend-maven-plugin</artifactId>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-scm-publish-plugin</artifactId>
            </plugin>
        </plugins>

        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-clean-plugin</artifactId>
                    <version>${maven.clean.plugin.version}</version>
                </plugin>
                <plugin>
                    <groupId>org.codehaus.mojo</groupId>
                    <artifactId>build-helper-maven-plugin</artifactId>
                    <version>${build.helper.maven.plugin.version}</version>
                    <executions>
                        <execution>
                            <id>add-source</id>
                            <phase>generate-sources</phase>
                            <goals>
                                <goal>add-source</goal>
                            </goals>
                            <configuration>
                                <sources>
                                    <source>src/main/xtend</source>
                                </sources>
                            </configuration>
                        </execution>
                        <execution>
                            <id>add-test-source</id>
                            <phase>generate-test-sources</phase>
                            <goals>
                                <goal>add-test-source</goal>
                            </goals>
                            <configuration>
                                <sources>
                                    <source>src/test/xtend</source>
                                </sources>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
                <plugin>
                    <groupId>org.eclipse.xtend</groupId>
                    <artifactId>xtend-maven-plugin</artifactId>
                    <version>${xtend.maven.version}</version>
                    <executions>
                        <execution>
                            <goals>
                                <goal>compile</goal>
                                <goal>testCompile</goal>
                            </goals>
                        </execution>
                    </executions>
                    <configuration>
                        <outputDirectory>${xtend.outputDir}</outputDirectory>
                        <testOutputDirectory>${xtend.testOutputDir}</testOutputDirectory>
                    </configuration>
                </plugin>
                <plugin>
                    <groupId>org.codehaus.mojo</groupId>
                    <artifactId>properties-maven-plugin</artifactId>
                    <version>${properties.maven.plugin.version}</version>
                    <executions>
                        <execution>
                            <phase>initialize</phase>
                            <goals>
                                <goal>write-project-properties</goal>
                            </goals>
                            <configuration>
                                <outputFile>${jbake.inputDirectory}/custom.properties</outputFile>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
                <plugin>
                    <groupId>com.google.code.maven-replacer-plugin</groupId>
                    <artifactId>replacer</artifactId>
                    <version>${replacer.plugin.version}</version>
                    <executions>
                        <execution>
                            <id>add-warning</id>
                            <phase>initialize</phase>
                            <goals>
                                <goal>replace</goal>
                            </goals>
                            <configuration>
                                <ignoreErrors>true</ignoreErrors>
                                <file>${jbake.inputDirectory}/custom.properties</file>
                                <regex>true</regex>
                                <replacements>
                                    <replacement>
                                        <token>^#Properties.*</token>
                                        <value>#WARNING: any change would be lost as it's a generated file. See
                                            jbake.properties
                                        </value>
                                    </replacement>
                                </replacements>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-scm-publish-plugin</artifactId>
                    <version>${maven.scm.publish.plugin.version}</version>
                    <inherited>true</inherited>
                    <configuration>
                        <checkinComment>
                            Publishing blog site for
                            ${project.artifactId}:${project.version}
                        </checkinComment>
                        <skipDeletedFiles>false</skipDeletedFiles>
                        <content>${project.build.directory}/${project.build.finalName}</content>
                        <!-- pubScmUrl default value can't be used here 
                            as distributionManagement.site.url value is set 
                            to deal with multi module staging -->
                        <pubScmUrl>${scm.publish.pubScmUrl}</pubScmUrl>
                        <scmBranch>${scm.publish.scmBranch}</scmBranch>
                        <addUniqueDirectory>true</addUniqueDirectory>
                    </configuration>
                </plugin>
                <plugin>
                    <groupId>org.codehaus.gmavenplus</groupId>
                    <artifactId>gmavenplus-plugin</artifactId>
                    <version>${gmavenplus.plugin.version}</version>
                    <dependencies>
                        <dependency>
                            <groupId>org.codehaus.groovy</groupId>
                            <artifactId>groovy-all</artifactId>
                                <!-- any version of Groovy >= 1.5.0 should work here -->
                            <version>${groovy.version}</version>
                        </dependency>
                    </dependencies>
                </plugin>
                <plugin>
                    <groupId>br.com.ingenieux</groupId>
                    <artifactId>jbake-maven-plugin</artifactId>
                    <version>${jbake.maven.plugin.version}</version>
                    <executions>
                        <execution>
                            <id>default-generate</id>
                            <phase>process-resources</phase>
                            <goals>
                                <goal>generate</goal>
                            </goals>
                        </execution>
                    </executions>
                    <dependencies>
                        <dependency>
                            <groupId>org.jbake</groupId>
                            <artifactId>jbake-core</artifactId>
                            <version>${jbake.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.slf4j</groupId>
                            <artifactId>log4j-over-slf4j</artifactId>
                            <version>${slf4j.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.slf4j</groupId>
                            <artifactId>slf4j-api</artifactId>
                            <version>${slf4j.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>ch.qos.logback</groupId>
                            <artifactId>logback-classic</artifactId>
                            <version>${logback.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.codehaus.groovy</groupId>
                            <artifactId>groovy-all</artifactId>
                            <version>${groovy.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.freemarker</groupId>
                            <artifactId>freemarker</artifactId>
                            <version>${freemarker.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.pegdown</groupId>
                            <artifactId>pegdown</artifactId>
                            <version>${markdown.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.asciidoctor</groupId>
                            <artifactId>asciidoctorj</artifactId>
                            <version>${asciidoc.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.apache.commons</groupId>
                            <artifactId>commons-lang3</artifactId>
                            <version>${commons.lang3.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>${project.artifactId}</artifactId>
                            <version>${project.version}</version>
                        </dependency>
                    </dependencies>
                </plugin>
                <plugin>
                    <groupId>com.github.sviperll</groupId>
                    <artifactId>coreext-maven-plugin</artifactId>
                    <version>${coreext.maven.plugin.version}</version>
                    <configuration>
                        <extensions combine.children="append">
                            <extension>
                                <groupId>com.github.sviperll</groupId>
                                <artifactId>maven-profiledep-extension</artifactId>
                                <version>${sviperll.extension.version}</version>
                            </extension>
                        </extensions>
                    </configuration>
                    <executions>
                        <execution>
                            <id>check-coreext</id>
                            <goals>
                                <goal>check</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>
                <plugin>
                    <groupId>com.samaxes.maven</groupId>
                    <artifactId>minify-maven-plugin</artifactId>
                    <version>${minify.maven.plugin.version}</version>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <version>${maven.compiler.plugin.version}</version>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-dependency-plugin</artifactId>
                    <version>${maven.dependency.plugin.version}</version>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-resources-plugin</artifactId>
                    <version>${maven.resources.plugin.version}</version>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-surefire-plugin</artifactId>
                    <version>${maven.surefire.plugin.version}</version>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-jar-plugin</artifactId>
                    <version>${maven.jar.plugin.version}</version>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-install-plugin</artifactId>
                    <version>${maven.install.plugin.version}</version>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-deploy-plugin</artifactId>
                    <version>${maven.deploy.plugin.version}</version>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-site-plugin</artifactId>
                    <version>${maven.site.plugin.version}</version>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>

    <profiles>

<!--         <profile> -->
<!--             <id>generate-blog</id> -->
<!--             <activation> -->
<!--                 <property> -->
<!--                     <name>generate-blog</name> -->
<!--                 </property> -->
<!--             </activation> -->
<!--             <build> -->
<!--                 <plugins> -->
<!--                     <plugin> -->
<!--                         <groupId>br.com.ingenieux</groupId> -->
<!--                         <artifactId>jbake-maven-plugin</artifactId> -->
<!--                     </plugin> -->
<!--                 </plugins> -->
<!--             </build> -->
<!--         </profile> -->

        <profile>
            <id>bootswatch-pathes</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.codehaus.gmavenplus</groupId>
                        <artifactId>gmavenplus-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>set-bootswatch-pathes</id>
                                <phase>initialize</phase>
                                <goals>
                                    <goal>execute</goal>
                                </goals>
                                <configuration>
                                    <scripts>
                                        <script><![CDATA[
                                if ( project.properties['bootswatch.style']
                                         && project.properties['bootswatch.style'] != "bootswatch" ) {
                                    project.properties['bootswatch.path.in'] = project.properties['bootswatch.style']
                                    project.properties['bootswatch.path.out'] = project.properties['bootswatch.style']
                                } else {
                                    project.properties['bootswatch.path.in'] = "bower_components/bootstrap/dist/css"
                                    project.properties['bootswatch.path.out'] = "bootswatch"
                                }
                                        ]]></script>
                                    </scripts>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>minify</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>com.samaxes.maven</groupId>
                        <artifactId>minify-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>minify-shl-with-webjars</id>
                                <phase>process-resources</phase>
                                <goals>
                                    <goal>minify</goal>
                                </goals>
                            </execution>
                        </executions>
                        <configuration>
                            <webappSourceDir>${assets.final.dir}</webappSourceDir>
                            <webappTargetDir>${assets.final.dir}</webappTargetDir>

                            <cssSourceDir>syntaxhighlighter/styles</cssSourceDir>
                            <cssSourceIncludes>
                                <include>*</include>
                            </cssSourceIncludes>
                            <cssSourceExcludes>
                                <exclude>*${lib.min}.css</exclude>
                            </cssSourceExcludes>
                            <cssTargetDir>syntaxhighlighter/styles</cssTargetDir>

                            <jsSourceDir>syntaxhighlighter/scripts</jsSourceDir>
                            <jsSourceIncludes>
                                <include>*</include>
                            </jsSourceIncludes>
                            <jsSourceExcludes>
                                <exclude>*${lib.min}.js</exclude>
                            </jsSourceExcludes>
                            <jsTargetDir>syntaxhighlighter/scripts</jsTargetDir>

                            <skipMerge>true</skipMerge>
                            <yuiNoMunge>true</yuiNoMunge>
                            <verbose>false</verbose>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>webjars</id>
            <activation>
                <property>
                    <name>webjars</name>
                </property>
            </activation>
            <properties>
                <profile.depends>bootswatch-pathes</profile.depends>
                <profile.depends>minify</profile.depends>

                <assets.final.dir>${jbake.inputDirectory}${asset.folder}/vendor</assets.final.dir>
                <assets.tmp.dir>${project.build.directory}/webjars-content</assets.tmp.dir>
                <webjar.groupId>org.webjars</webjar.groupId>
            </properties>
            <dependencies>
                <dependency>
                    <groupId>org.webjars</groupId>
                    <artifactId>jquery</artifactId>
                </dependency>
                <dependency>
                    <groupId>org.webjars</groupId>
                    <artifactId>bootstrap</artifactId>
                </dependency>
                <dependency>
                    <groupId>org.webjars</groupId>
                    <artifactId>font-awesome</artifactId>
                </dependency>
                <dependency>
                    <groupId>org.webjars</groupId>
                    <artifactId>syntaxhighlighter</artifactId>
                </dependency>
                <dependency>
                    <groupId>org.webjars</groupId>
                    <artifactId>html5shiv</artifactId>
                </dependency>
                <dependency>
                    <groupId>org.webjars</groupId>
                    <artifactId>respond</artifactId>
                </dependency>
                <dependency>
                    <groupId>org.webjars</groupId>
                    <artifactId>bootswatch</artifactId>
                </dependency>
            </dependencies>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-clean-plugin</artifactId>
                        <configuration>
                            <filesets>
                                <fileset>
                                    <directory>${assets.final.dir}</directory>
                                    <followSymlinks>false</followSymlinks>
                                </fileset>
                            </filesets>
                        </configuration>
                    </plugin>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-dependency-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>download-and-unpack-assets</id>
                                <phase>generate-sources</phase>
                                <goals>
                                    <goal>unpack-dependencies</goal>
                                </goals>
                                <configuration>
                                    <outputDirectory>${assets.tmp.dir}</outputDirectory>
                                    <includeGroupIds>${webjar.groupId}</includeGroupIds>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                    <plugin>
                        <!-- maven-dependency-plugin:unpack-dependencies is unable to deal 
                             with the version part of the path used inside webjar archives, 
                             i.e. /META-INF/resources/webjars/<artifactId>/<version> -->
                        <groupId>org.codehaus.gmavenplus</groupId>
                        <artifactId>gmavenplus-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>remove-version-from-path</id>
                                <phase>process-sources</phase>
                                <goals>
                                    <goal>execute</goal>
                                </goals>
                                <configuration>
                                    <scripts>
                                        <script><![CDATA[
                import java.nio.file.*
                                        
                def tmpDirPath = Paths.get("${assets.tmp.dir}")
                def finalDirPath = Paths.get("${assets.final.dir}")
                if(Files.notExists(finalDirPath)) {
                    System.out.printf("%s does not exist. Creating...\n", finalDirPath);
                    Files.createDirectories(finalDirPath);
                }

                project.dependencies.findAll {it.groupId.contains("${webjar.groupId}")}.each {
                  def srcDirPath = 
                    tmpDirPath.resolve("META-INF/resources/webjars/${it.artifactId}/${it.version}")
                  def destDirPath = finalDirPath.resolve(it.artifactId)
                  
                  destDirPath.toFile().deleteDir()
                  if (srcDirPath.toString().contains("bootswatch")) {
                    srcDirPath = srcDirPath.resolve("${bootswatch.style}")
                    destDirPath = destDirPath.resolve("${bootswatch.style}")
                  }
                  new AntBuilder().copy( todir:"${destDirPath}" ) {
                    fileset( dir:"${srcDirPath}" ) {
                      include(name:"**/*.js")
                      include(name:"**/*.css")
                      include(name:"**/fonts/*")
                    }
                  }
                }
                                       ]]></script>
                                    </scripts>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>enforce</id>
            <activation>
                <property>
                    <name>enforce</name>
                </property>
            </activation>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-enforcer-plugin</artifactId>
                    </plugin>
                    <plugin>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>versions-maven-plugin</artifactId>
                    </plugin>
                </plugins>
                <pluginManagement>
                    <plugins>
                        <plugin>
                            <groupId>org.codehaus.mojo</groupId>
                            <artifactId>build-helper-maven-plugin</artifactId>
                            <executions>
                                <execution>
                                    <id>get-maven-version</id>
                                    <goals>
                                        <goal>maven-version</goal>
                                    </goals>
                                </execution>
                            </executions>
                        </plugin>
                        <plugin>
                            <groupId>org.apache.maven.plugins</groupId>
                            <artifactId>maven-enforcer-plugin</artifactId>
                            <version>${maven.enforcer.plugin.version}</version>
                            <executions>
                                <execution>
                                    <id>enforce-versions</id>
                                    <goals>
                                        <goal>enforce</goal>
                                    </goals>
                                    <configuration>
                                        <fail>true</fail>
                                        <rules>
                                            <requireMavenVersion>
                                                <version>${maven.minimal.version}</version>
                                                <message><![CDATA[[ERROR] OLD MAVEN [${maven.version}] in use. 
                                                Maven ${maven.minimal.version} or newer is required.]]>
                                                </message>
                                            </requireMavenVersion>
                                            <requireJavaVersion>
                                                <version>${jdk.version}</version>
                                                <message><![CDATA[[ERROR] OLD JDK [${java.version}] in use. 
                                                JDK ${jdk.version} or newer is required.]]>
                                                </message>
                                            </requireJavaVersion>
                                            <requirePluginVersions>
                                                <banLatest>true</banLatest>
                                                <banRelease>true</banRelease>
                                                <banSnapshots>true</banSnapshots>
                                            </requirePluginVersions>
                                            <bannedDependencies>
                                                <searchTransitive>true</searchTransitive>
                                                <excludes>
                                                    <exclude>commons-logging</exclude>
                                                    <exclude>log4j</exclude>
                                                    <exclude>org.apache.logging.log4j</exclude>

                                                    <exclude>org.slf4j:slf4j-log4j12</exclude>
                                                    <exclude>org.slf4j:slf4j-jdk14</exclude>
                                                </excludes>
                                            </bannedDependencies>
                                        </rules>
                                    </configuration>
                                </execution>
                            </executions>
                        </plugin>
                        <plugin>
                            <groupId>org.codehaus.mojo</groupId>
                            <artifactId>versions-maven-plugin</artifactId>
                            <version>${versions.maven.plugin.version}</version>
                            <configuration>
                                <!-- required to avoid warning with new alpha, beta, ... versions -->
                                <rulesUri>file://${project.basedir}/src/conf/versionrules.xml</rulesUri>
                            </configuration>
                            <executions>
                                <execution>
                                    <id>check-versions</id>
                                    <phase>validate</phase><!-- no default phase -->
                                    <goals>
                                        <goal>display-dependency-updates</goal>
                                        <goal>display-plugin-updates</goal>
                                        <goal>display-property-updates</goal>
                                    </goals>
                                </execution>
                            </executions>
                        </plugin>
                    </plugins>
                </pluginManagement>
            </build>
        </profile>

        <profile>
            <id>only-under-eclipse</id>
            <activation>
                <property>
                    <name>m2e.version</name>
                </property>
            </activation>
            <build>
                <pluginManagement>
                    <plugins>
                        <plugin>
                            <groupId>org.eclipse.m2e</groupId>
                            <artifactId>lifecycle-mapping</artifactId>
                            <version>1.0.0</version>
                            <configuration>
                                <lifecycleMappingMetadata>
                                    <pluginExecutions>
                                        <pluginExecution>
                                            <pluginExecutionFilter>
                                                <groupId>com.google.code.maven-replacer-plugin</groupId>
                                                <artifactId>replacer</artifactId>
                                                <versionRange>${replacer.plugin.version}</versionRange>
                                                <goals>
                                                    <goal>replace</goal>
                                                </goals>
                                            </pluginExecutionFilter>
                                            <action>
                                                <execute>
                                                    <runOnIncremental>false</runOnIncremental><!-- to avoid looping -->
                                                    <runOnConfiguration>true</runOnConfiguration>
                                                </execute>
                                            </action>
                                        </pluginExecution>
                                        <pluginExecution>
                                            <pluginExecutionFilter>
                                                <groupId>org.codehaus.mojo</groupId>
                                                <artifactId>properties-maven-plugin</artifactId>
                                                <versionRange>${properties.maven.plugin.version}</versionRange>
                                                <goals>
                                                    <goal>write-project-properties</goal>
                                                </goals>
                                            </pluginExecutionFilter>
                                            <action>
                                                <ignore />
                                            </action>
                                        </pluginExecution>
                                        <pluginExecution>
                                            <pluginExecutionFilter>
                                                <groupId>br.com.ingenieux</groupId>
                                                <artifactId>jbake-maven-plugin</artifactId>
                                                <versionRange>${jbake.maven.plugin.version}</versionRange>
                                                <goals>
                                                    <goal>generate</goal>
                                                </goals>
                                            </pluginExecutionFilter>
                                            <action>
                                                <ignore />
                                            </action>
                                        </pluginExecution>
                                        <pluginExecution>
                                            <pluginExecutionFilter>
                                                <groupId>com.github.sviperll</groupId>
                                                <artifactId>coreext-maven-plugin</artifactId>
                                                <versionRange>${coreext.maven.plugin.version}</versionRange>
                                                <goals>
                                                    <goal>check</goal>
                                                </goals>
                                            </pluginExecutionFilter>
                                            <action>
                                                <ignore />
                                            </action>
                                        </pluginExecution>
                                <pluginExecution>
                                    <pluginExecutionFilter>
                                        <groupId>org.codehaus.mojo</groupId>
                                        <artifactId>build-helper-maven-plugin</artifactId>
                                        <versionRange>${build.helper.maven.plugin.version}</versionRange>
                                        <goals>
                                            <goal>add-source</goal>
                                            <goal>add-test-source</goal>
                                        </goals>
                                    </pluginExecutionFilter>
                                    <action>
                                        <ignore></ignore>
                                    </action>
                                </pluginExecution>
                                    </pluginExecutions>
                                </lifecycleMappingMetadata>
                            </configuration>
                        </plugin>
                    </plugins>
                </pluginManagement>
            </build>
        </profile>

    </profiles>

    <dependencies>
        <dependency>
            <groupId>org.eclipse.xtend</groupId>
            <artifactId>org.eclipse.xtend.lib</artifactId>
        </dependency>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
        </dependency>
        <dependency>
            <groupId>org.hamcrest</groupId>
            <artifactId>hamcrest-all</artifactId>
        </dependency>
        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-lang3</artifactId>
        </dependency>
        <dependency>
            <groupId>com.rometools</groupId>
            <artifactId>rome-fetcher</artifactId>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
        </dependency>
        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-classic</artifactId>
        </dependency>
<!--         <dependency> -->
<!--             <groupId>org.codehaus.groovy</groupId> -->
<!--             <artifactId>groovy-all</artifactId> -->
<!--         </dependency> -->
        <dependency>
            <groupId>org.apache.tika</groupId>
            <artifactId>tika-parsers</artifactId>
        </dependency>
    </dependencies>

    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>org.eclipse.xtend</groupId>
                <artifactId>org.eclipse.xtend.lib</artifactId>
                <version>${xtend.version}</version>
            </dependency>
            <dependency>
                <groupId>org.webjars</groupId>
                <artifactId>jquery</artifactId>
                <version>${jquery.version}</version>
            </dependency>
            <dependency>
                <groupId>org.webjars</groupId>
                <artifactId>bootstrap</artifactId>
                <version>${bootstrap.version}</version>
            </dependency>
            <dependency>
                <groupId>org.webjars</groupId>
                <artifactId>font-awesome</artifactId>
                <version>${fontawesome.version}</version>
            </dependency>
            <dependency>
                <groupId>org.webjars</groupId>
                <artifactId>syntaxhighlighter</artifactId>
                <version>${syntaxhighlighter.version}</version>
            </dependency>
            <dependency>
                <groupId>org.webjars</groupId>
                <artifactId>html5shiv</artifactId>
                <version>${html5shiv.version}</version>
            </dependency>
            <dependency>
                <groupId>org.webjars</groupId>
                <artifactId>respond</artifactId>
                <version>${respond.version}</version>
            </dependency>
            <dependency>
                <groupId>org.webjars</groupId>
                <artifactId>bootswatch</artifactId>
                <version>${bootswatch.version}</version>
            </dependency>

            <dependency>
                <groupId>org.slf4j</groupId>
                <artifactId>jcl-over-slf4j</artifactId>
                <version>${slf4j.version}</version>
            </dependency>
            <dependency>
                <groupId>ch.qos.logback</groupId>
                <artifactId>logback-classic</artifactId>
                <version>${logback.version}</version>
            </dependency>
            <dependency>
                <groupId>org.codehaus.groovy</groupId>
                <artifactId>groovy-all</artifactId>
                <version>${groovy.version}</version>
            </dependency>

            <dependency>
                <groupId>junit</groupId>
                <artifactId>junit</artifactId>
                <version>${junit.version}</version>
                <scope>test</scope>
            </dependency>
            <dependency>
                <groupId>org.hamcrest</groupId>
                <artifactId>hamcrest-all</artifactId>
                <version>${hamcrest.version}</version>
                <scope>test</scope>
            </dependency>

            <dependency>
                <groupId>org.apache.commons</groupId>
                <artifactId>commons-lang3</artifactId>
                <version>${commons.lang3.version}</version>
                <scope>test</scope>
            </dependency>
            <dependency>
                <groupId>com.rometools</groupId>
                <artifactId>rome-fetcher</artifactId>
                <version>${rss.version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>commons-logging</groupId>
                        <artifactId>commons-logging</artifactId>
                    </exclusion>
                </exclusions>
            </dependency>
            <dependency>
                <groupId>org.apache.tika</groupId>
                <artifactId>tika-parsers</artifactId>
                <version>${tika.version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>commons-logging</groupId>
                        <artifactId>commons-logging</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>com.github.junrar</groupId>
                        <artifactId>junrar</artifactId>
                    </exclusion>
                    <exclusion>
                        <artifactId>pdfbox</artifactId>
                        <groupId>org.apache.pdfbox</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>poi-scratchpad</artifactId>
                        <groupId>org.apache.poi</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>poi</artifactId>
                        <groupId>org.apache.poi</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>poi-ooxml</artifactId>
                        <groupId>org.apache.poi</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>netcdf</artifactId>
                        <groupId>edu.ucar</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>vorbis-java-tika</artifactId>
                        <groupId>org.gagravarr</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>apache-mime4j-core</artifactId>
                        <groupId>org.apache.james</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>apache-mime4j-dom</artifactId>
                        <groupId>org.apache.james</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>bcmail-jdk15</artifactId>
                        <groupId>org.bouncycastle</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>isoparser</artifactId>
                        <groupId>com.googlecode.mp4parser</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>rome</artifactId>
                        <groupId>rome</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>vorbis-java-core</artifactId>
                        <groupId>org.gagravarr</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>juniversalchardet</artifactId>
                        <groupId>com.googlecode.juniversalchardet</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>metadata-extractor</artifactId>
                        <groupId>com.drewnoakes</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>bcprov-jdk15</artifactId>
                        <groupId>org.bouncycastle</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>commons-codec</artifactId>
                        <groupId>commons-codec</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>xz</artifactId>
                        <groupId>org.tukaani</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>jmatio</artifactId>
                        <groupId>net.sourceforge.jmatio</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>commons-compress</artifactId>
                        <groupId>org.apache.commons</groupId>
                    </exclusion>
                    <exclusion>
                        <artifactId>java-libpst</artifactId>
                        <groupId>com.pff</groupId>
                    </exclusion>
                </exclusions>
            </dependency>

        </dependencies>
    </dependencyManagement>

</project>
